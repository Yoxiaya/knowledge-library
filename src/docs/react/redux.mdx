Redux 的工作流程是基于 **单向数据流** 的核心原则，它帮助我们管理和更新应用的状态。简而言之，Redux 的工作流程包括以下几个主要步骤：

### 1. **State（状态）**

Redux 中的应用状态（State）是一个 **JavaScript 对象**，它存储了应用的所有数据。在 Redux 中，状态是不可变的，意味着你不能直接修改状态，而是通过派发动作（Action）来更新它。

### 2. **Action（动作）**

**Action** 是一个普通的 JavaScript 对象，它描述了发生的事件。一个 Action 至少需要有一个 `type` 属性，表示事件的类型。它可以包含额外的数据，称为 **payload**。

例如，添加一个新的商品到购物车：

```js
{
  type: 'ADD_TO_CART',
  payload: { id: 1, name: 'Product A', quantity: 1 }
}
```

### 3. **Dispatch（派发）**

**Dispatch** 是一个 Redux store 方法，用于触发 Action。通过 `dispatch`，你可以将一个 Action 发到 Redux 的 **reducer**，从而改变应用的状态。

```js
dispatch({
    type: 'ADD_TO_CART',
    payload: { id: 1, name: 'Product A', quantity: 1 },
})
```

### 4. **Reducer（简化函数）**

**Reducer** 是一个纯函数，接受当前的 state 和一个 action，返回一个新的 state。Reducer 根据不同的 `action.type` 执行相应的状态变更。

Reducer 的工作原理类似一个 "状态变化规则"：它告诉应用在特定 Action 被派发时，状态应该如何更新。Reducer 必须是纯函数，即对相同的输入返回相同的输出，并且不能有副作用（如直接修改 state）。

```js
const initialState = {
    cart: [],
}

const cartReducer = (state = initialState, action) => {
    switch (action.type) {
        case 'ADD_TO_CART':
            return {
                ...state,
                cart: [...state.cart, action.payload],
            }
        default:
            return state
    }
}
```

### 5. **Store（数据存储）**

**Store** 是 Redux 中保存应用状态的地方。它是唯一的数据源，所有的状态都存储在 Store 中。通过 `createStore()` 方法创建 Store，且 Store 中存储的状态只能通过 Dispatch Action 来更新。

```js
import { createStore } from 'redux'

const store = createStore(cartReducer)
```

### 6. **View（视图）**

视图是 React 组件，它通过 **订阅（subscription）** 来获取 Redux Store 中的状态。通常，React 组件会通过 `useSelector()` 来访问 Redux Store 中的状态，并通过 `useDispatch()` 来派发 Action。

```js
import React from 'react'
import { useSelector, useDispatch } from 'react-redux'
import { addToCart } from './actions'

const CartComponent = () => {
    const cart = useSelector((state) => state.cart)
    const dispatch = useDispatch()

    const handleAddToCart = () => {
        dispatch(addToCart({ id: 1, name: 'Product A', quantity: 1 }))
    }

    return (
        <div>
            <button onClick={handleAddToCart}>Add to Cart</button>
            <div>Cart: {cart.length} items</div>
        </div>
    )
}
```

### Redux 的完整流程概括：

1. **用户触发事件**，比如点击按钮或表单提交，`dispatch` 一个 Action。
2. **Action 发送到 Reducer**，Reducer 根据 Action 的类型和数据更新状态。
3. **Store 更新状态**，Store 存储新的状态。
4. **视图组件重新渲染**，组件通过 `useSelector()` 获取更新后的状态并重新渲染。

### 总结：

Redux 的核心理念是 **单向数据流**：**Action → Reducer → Store → View**。数据从 View 层流向 Store 层，状态更新后，Store 会通知 View 层重新渲染。这种结构使得应用的状态管理变得可预测、易于调试。
