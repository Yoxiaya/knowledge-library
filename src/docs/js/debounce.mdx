# 防抖（Debounce）

## React Demo 描述

页面展示两个输入框：

1. **非立即执行版**：停止输入 500ms 后更新内容
2. **立即执行版**：首次立即触发，后续需要等待延迟

用户可以通过输入来观察防抖效果。

## 什么是防抖？

防抖是指：多次触发事件，只在 **最后一次触发后的 delay 毫秒** 执行函数。

**目标：减少不必要的触发次数，避免频繁调用函数。**

常用于：

- 输入框实时搜索
- resize / scroll 结束后再计算
- 表单输入校验
- 按钮防重复提交

---

## 两种实现方式

### 1. 非立即执行（trailing）

特点：

- 不会立即执行
- 用户停止输入后才执行
- 常用于搜索防抖

### 2. 立即执行（leading）

特点：

- 第一次触发立即执行
- 后续 delay 时间内忽略
- 用于按钮点击等操作

---

## 对比

| 实现方式   | 是否立即执行 | 何时执行       |
| ---------- | ------------ | -------------- |
| 非立即执行 | ✖ 否         | 最后一次触发后 |
| 立即执行   | ✔ 是         | 第一次立即执行 |

---

## 代码实现

```typescript
export function debounce(fn: (...args: any[]) => void, delay: number) {
    let timer: any = null

    return function (...args: any[]) {
        if (timer) clearTimeout(timer)

        timer = setTimeout(() => {
            fn(...args)
        }, delay)
    }
}
export function debounceImmediate(fn: (...args: any[]) => void, delay: number) {
    let timer: any = null

    return (...args: any[]) => {
        const isFirst = !timer

        if (timer) clearTimeout(timer)

        timer = setTimeout(() => {
            timer = null
        }, delay)

        if (isFirst) {
            fn(...args)
        }
    }
}
```
